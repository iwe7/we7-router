{
  "version": 3,
  "file": "we7-core.umd.js",
  "sources": [
    "ng://we7-core/out/net/default.interceptor.ts",
    "ng://we7-core/out/startup/startup.service.ts",
    "ng://we7-core/out/tools/we7.service.ts",
    "ng://we7-core/out/module-import-guard.ts"
  ],
  "sourcesContent": [
    "import { Injectable, Injector } from '@angular/core';\nimport { Router } from '@angular/router';\nimport {\n    HttpInterceptor, HttpRequest, HttpHandler, HttpErrorResponse,\n    HttpSentEvent, HttpHeaderResponse, HttpProgressEvent, HttpResponse, HttpUserEvent,\n} from '@angular/common/http';\nimport { Observable } from 'rxjs/Observable';\nimport { of } from 'rxjs/observable/of';\nimport { ErrorObservable } from 'rxjs/observable/ErrorObservable';\nimport { mergeMap, catchError } from 'rxjs/operators';\nimport { NzMessageService } from 'ng-zorro-antd';\nimport { _HttpClient } from '@delon/theme';\n\n/**\n * 默认HTTP拦截器，其注册细节见 `app.module.ts`\n */\n@Injectable()\nexport class DefaultInterceptor implements HttpInterceptor {\n    constructor(private injector: Injector) { }\n    get msg(): NzMessageService {\n        return this.injector.get(NzMessageService);\n    }\n    private goTo(url: string) {\n        setTimeout(() => this.injector.get(Router).navigateByUrl(url));\n    }\n    private handleData(event: HttpResponse<any> | HttpErrorResponse): Observable<any> {\n        // 可能会因为 `throw` 导出无法执行 `_HttpClient` 的 `end()` 操作\n        this.injector.get(_HttpClient).end();\n        // 业务处理：一些通用操作\n        switch (event.status) {\n            case 200:\n                // 业务层级错误处理，以下假如响应体的 `status` 若不为 `0` 表示业务级异常\n                // 并显示 `error_message` 内容\n                // const body: any = event instanceof HttpResponse && event.body;\n                // if (body && body.status !== 0) {\n                //     this.msg.error(body.error_message);\n                //     // 继续抛出错误中断后续所有 Pipe、subscribe 操作，因此：\n                //     // this.http.get('/').subscribe() 并不会触发\n                //     return ErrorObservable.throw(event);\n                // }\n                break;\n            case 401: // 未登录状态码\n                this.goTo('/passport/login');\n                break;\n            case 403:\n            case 404:\n            case 500:\n                this.goTo(`/${event.status}`);\n                break;\n        }\n        return of(event);\n    }\n\n    intercept(req: HttpRequest<any>, next: HttpHandler):\n        Observable<HttpSentEvent | HttpHeaderResponse | HttpProgressEvent | HttpResponse<any> | HttpUserEvent<any>> {\n        let url = req.url;\n        const newReq = req.clone({\n            url: url\n        });\n        return next.handle(newReq).pipe(\n            mergeMap((event: any) => {\n                if (event instanceof HttpResponse && event.status === 200)\n                    return this.handleData(event);\n                return of(event);\n            }),\n            catchError((err: HttpErrorResponse) => this.handleData(err))\n        );\n    }\n}\n",
    "import { Injectable, Injector, Inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Router } from '@angular/router';\nimport { zip } from 'rxjs/observable/zip';\nimport { catchError } from 'rxjs/operators';\nimport { MenuService, SettingsService, TitleService } from '@delon/theme';\nimport { ACLService } from '@delon/acl';\nimport { ITokenService, DA_SERVICE_TOKEN } from '@delon/auth';\nimport { We7Service } from '../tools/we7.service';\n\n@Injectable()\nexport class StartupService {\n    constructor(\n        private menuService: MenuService,\n        private settingService: SettingsService,\n        private aclService: ACLService,\n        private titleService: TitleService,\n        @Inject(DA_SERVICE_TOKEN) private tokenService: ITokenService,\n        private httpClient: HttpClient,\n        private injector: Injector,\n        private we7: We7Service\n    ) {\n\n    }\n\n    load() {\n        let url = this.we7.getWebUrl('open', { open: 'appconfig' })\n        this.httpClient.get(url).subscribe(res => {\n            console.log(res);\n        });\n    }\n}",
    "import { Injectable } from '@angular/core';\n\n@Injectable()\nexport class We7Service {\n    queryParams: any = {};\n    constructor() {\n        this.queryParams = this.parseURL();\n    }\n\n    parseURL(): { [k: string]: string } {\n        const ret = {};\n        const seg = location.search.replace(/^\\?/, '').split('&').filter(function (v, i) {\n            if (v !== '' && v.indexOf('=')) {\n                return true;\n            }\n        });\n        seg.forEach((element, index) => {\n            const idx = element.indexOf('=');\n            const key = element.substring(0, idx);\n            const val = element.substring(idx + 1);\n            ret[key] = val;\n        });\n        return ret;\n    }\n\n    setQuerParams(queryParams: any) {\n        this.queryParams = queryParams;\n        return this;\n    }\n\n    get(name: string) {\n        return this.queryParams[name];\n    }\n\n    getUrl(_params: any = {}) {\n        let url = this.serializeQueryParams({ ...this.queryParams, ..._params });\n        return `${url}`;\n    }\n\n    getMobileUrl(_do: string, _params: any = {}) {\n        _params['a'] = 'site';\n        _params['c'] = 'entry';\n        _params['i'] = this.get('i') ? this.get('i') : '2';\n        _params['do'] = _do;\n        return `${location.protocol}//${location.host}/app/index.php${this.getUrl(_params)}`;\n    }\n\n    getWebUrl(_do: string, _params: any = {}) {\n        _params['a'] = 'entry';\n        _params['c'] = 'site';\n        _params['i'] = this.get('i') ? this.get('i') : '2';\n        _params['do'] = _do;\n        return `${location.protocol}//${location.host}/web/index.php${this.getUrl(_params)}`;\n    }\n\n    serializeQueryParams(params: { [key: string]: any }): string {\n        const strParams: string[] = Object.keys(params).map((name) => {\n            const value = params[name];\n            return Array.isArray(value) ?\n                value.map(v => `${this.encodeUriQuery(name)}=${this.encodeUriQuery(v)}`).join('&') :\n                `${this.encodeUriQuery(name)}=${this.encodeUriQuery(value)}`;\n        });\n        return strParams.length ? `?${strParams.join(\"&\")}` : '';\n    }\n\n    encodeUriQuery(s: string): string {\n        return this.encodeUriString(s).replace(/%3B/gi, ';');\n    }\n\n    encodeUriString(s: string): string {\n        return encodeURIComponent(s)\n            .replace(/%40/g, '@')\n            .replace(/%3A/gi, ':')\n            .replace(/%24/g, '$')\n            .replace(/%2C/gi, ',');\n    }\n}",
    "export function throwIfAlreadyLoaded(parentModule: any, moduleName: string) {\n    if (parentModule) {\n        throw new Error(`${moduleName} has already been loaded. Import Core modules in the AppModule only.`);\n    }\n}\n"
  ],
  "names": [
    "Injector",
    "Injectable",
    "catchError",
    "of",
    "HttpResponse",
    "mergeMap",
    "_HttpClient",
    "Router",
    "NzMessageService",
    "HttpClient",
    "Inject",
    "DA_SERVICE_TOKEN",
    "TitleService",
    "ACLService",
    "SettingsService",
    "MenuService"
  ],
  "mappings": "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"
}
