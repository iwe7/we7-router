{
  "version": 3,
  "file": "we7-core.js",
  "sources": [
    "ng://we7-core/out/net/default.interceptor.ts",
    "ng://we7-core/out/startup/startup.service.ts",
    "ng://we7-core/out/tools/we7.service.ts",
    "ng://we7-core/out/module-import-guard.ts"
  ],
  "sourcesContent": [
    "import { Injectable, Injector } from '@angular/core';\nimport { Router } from '@angular/router';\nimport {\n    HttpInterceptor, HttpRequest, HttpHandler, HttpErrorResponse,\n    HttpSentEvent, HttpHeaderResponse, HttpProgressEvent, HttpResponse, HttpUserEvent,\n} from '@angular/common/http';\nimport { Observable } from 'rxjs/Observable';\nimport { of } from 'rxjs/observable/of';\nimport { ErrorObservable } from 'rxjs/observable/ErrorObservable';\nimport { mergeMap, catchError } from 'rxjs/operators';\nimport { NzMessageService } from 'ng-zorro-antd';\nimport { _HttpClient } from '@delon/theme';\n\n/**\n * 默认HTTP拦截器，其注册细节见 `app.module.ts`\n */\n@Injectable()\nexport class DefaultInterceptor implements HttpInterceptor {\n    constructor(private injector: Injector) { }\n    get msg(): NzMessageService {\n        return this.injector.get(NzMessageService);\n    }\n    private goTo(url: string) {\n        setTimeout(() => this.injector.get(Router).navigateByUrl(url));\n    }\n    private handleData(event: HttpResponse<any> | HttpErrorResponse): Observable<any> {\n        // 可能会因为 `throw` 导出无法执行 `_HttpClient` 的 `end()` 操作\n        this.injector.get(_HttpClient).end();\n        // 业务处理：一些通用操作\n        switch (event.status) {\n            case 200:\n                // 业务层级错误处理，以下假如响应体的 `status` 若不为 `0` 表示业务级异常\n                // 并显示 `error_message` 内容\n                // const body: any = event instanceof HttpResponse && event.body;\n                // if (body && body.status !== 0) {\n                //     this.msg.error(body.error_message);\n                //     // 继续抛出错误中断后续所有 Pipe、subscribe 操作，因此：\n                //     // this.http.get('/').subscribe() 并不会触发\n                //     return ErrorObservable.throw(event);\n                // }\n                break;\n            case 401: // 未登录状态码\n                this.goTo('/passport/login');\n                break;\n            case 403:\n            case 404:\n            case 500:\n                this.goTo(`/${event.status}`);\n                break;\n        }\n        return of(event);\n    }\n\n    intercept(req: HttpRequest<any>, next: HttpHandler):\n        Observable<HttpSentEvent | HttpHeaderResponse | HttpProgressEvent | HttpResponse<any> | HttpUserEvent<any>> {\n        let url = req.url;\n        const newReq = req.clone({\n            url: url\n        });\n        return next.handle(newReq).pipe(\n            mergeMap((event: any) => {\n                if (event instanceof HttpResponse && event.status === 200)\n                    return this.handleData(event);\n                return of(event);\n            }),\n            catchError((err: HttpErrorResponse) => this.handleData(err))\n        );\n    }\n}\n",
    "import { Injectable, Injector, Inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Router } from '@angular/router';\nimport { zip } from 'rxjs/observable/zip';\nimport { catchError } from 'rxjs/operators';\nimport { MenuService, SettingsService, TitleService } from '@delon/theme';\nimport { ACLService } from '@delon/acl';\nimport { ITokenService, DA_SERVICE_TOKEN } from '@delon/auth';\nimport { We7Service } from '../tools/we7.service';\n\n@Injectable()\nexport class StartupService {\n    constructor(\n        private menuService: MenuService,\n        private settingService: SettingsService,\n        private aclService: ACLService,\n        private titleService: TitleService,\n        @Inject(DA_SERVICE_TOKEN) private tokenService: ITokenService,\n        private httpClient: HttpClient,\n        private injector: Injector,\n        private we7: We7Service\n    ) {\n\n    }\n\n    load() {\n        let url = this.we7.getWebUrl('open', { open: 'appconfig' })\n        this.httpClient.get(url).subscribe(res => {\n            console.log(res);\n        });\n    }\n}",
    "import { Injectable } from '@angular/core';\n\n@Injectable()\nexport class We7Service {\n    queryParams: any = {};\n    constructor() {\n        this.queryParams = this.parseURL();\n    }\n\n    parseURL(): { [k: string]: string } {\n        const ret = {};\n        const seg = location.search.replace(/^\\?/, '').split('&').filter(function (v, i) {\n            if (v !== '' && v.indexOf('=')) {\n                return true;\n            }\n        });\n        seg.forEach((element, index) => {\n            const idx = element.indexOf('=');\n            const key = element.substring(0, idx);\n            const val = element.substring(idx + 1);\n            ret[key] = val;\n        });\n        return ret;\n    }\n\n    setQuerParams(queryParams: any) {\n        this.queryParams = queryParams;\n        return this;\n    }\n\n    get(name: string) {\n        return this.queryParams[name];\n    }\n\n    getUrl(_params: any = {}) {\n        let url = this.serializeQueryParams({ ...this.queryParams, ..._params });\n        return `${url}`;\n    }\n\n    getMobileUrl(_do: string, _params: any = {}) {\n        _params['a'] = 'site';\n        _params['c'] = 'entry';\n        _params['i'] = this.get('i') ? this.get('i') : '2';\n        _params['do'] = _do;\n        return `${location.protocol}//${location.host}/app/index.php${this.getUrl(_params)}`;\n    }\n\n    getWebUrl(_do: string, _params: any = {}) {\n        _params['a'] = 'entry';\n        _params['c'] = 'site';\n        _params['i'] = this.get('i') ? this.get('i') : '2';\n        _params['do'] = _do;\n        return `${location.protocol}//${location.host}/web/index.php${this.getUrl(_params)}`;\n    }\n\n    serializeQueryParams(params: { [key: string]: any }): string {\n        const strParams: string[] = Object.keys(params).map((name) => {\n            const value = params[name];\n            return Array.isArray(value) ?\n                value.map(v => `${this.encodeUriQuery(name)}=${this.encodeUriQuery(v)}`).join('&') :\n                `${this.encodeUriQuery(name)}=${this.encodeUriQuery(value)}`;\n        });\n        return strParams.length ? `?${strParams.join(\"&\")}` : '';\n    }\n\n    encodeUriQuery(s: string): string {\n        return this.encodeUriString(s).replace(/%3B/gi, ';');\n    }\n\n    encodeUriString(s: string): string {\n        return encodeURIComponent(s)\n            .replace(/%40/g, '@')\n            .replace(/%3A/gi, ':')\n            .replace(/%24/g, '$')\n            .replace(/%2C/gi, ',');\n    }\n}",
    "export function throwIfAlreadyLoaded(parentModule: any, moduleName: string) {\n    if (parentModule) {\n        throw new Error(`${moduleName} has already been loaded. Import Core modules in the AppModule only.`);\n    }\n}\n"
  ],
  "names": [],
  "mappings": "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"
}
